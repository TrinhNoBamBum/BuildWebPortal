import{H as w,I as C,j as e,G as c,B as f,u as y,r,J}from"./index-BV4Nease.js";import{O as R,D as k,a as z,b as D,B as X,c as K,R as Q,d as U}from"./BoxCover-D9rhDFlx.js";import{a as A}from"./authornew-DInW004M.js";import{F as E,c as I,a as H}from"./formik.esm-DZjldY3N.js";import{a as F,R as Y,S as Z,P as _}from"./StyledDataGrid-FNaFrEdc.js";import{F as M,B as m}from"./InputLabel-WUsojO3a.js";import"./baseaxios-CTVpXELN.js";import"./TextField-BhRWA0TT.js";import"./FormControlLabel-M6Lp4kHF.js";import"./Skeleton-KZcenIcW.js";function ee({open:i,setOpen:s}){const o=w(),n=C(a=>a.organizationReducer),l=async a=>{(await A.AddAuthorNew({AuthorName:a.AuthorName})).status==200&&(o(F.status(!n.isFresh)),s(!1))},p=()=>{s(!1)};return e.jsx(e.Fragment,{children:e.jsx(E,{initialValues:{AuthorName:"",submit:null},validationSchema:I().shape({AuthorName:H().max(255).required("AuthorName is required")}),onSubmit:l,children:({errors:a,handleBlur:u,handleChange:x,handleSubmit:g,isSubmitting:h,touched:j,values:b})=>e.jsx("form",{noValidate:!0,onSubmit:g,children:e.jsxs(c,{container:!0,spacing:3,children:[e.jsx(R,{id:"author",lable:"Tên tác giả",values:b,placeholder:"Nhập tên tác giả",nameValue:"AuthorName",handleBlur:u,handleChange:x,touched:j,errors:a}),e.jsx(c,{item:!0,xs:12,sx:{mt:-1}}),a.submit&&e.jsx(c,{item:!0,xs:12,children:e.jsx(M,{error:!0,children:a.submit})}),e.jsx(c,{item:!0,xs:12,children:e.jsxs(f,{style:{float:"right"},children:[e.jsx(m,{disableElevation:!0,disabled:h,size:"small",variant:"contained",color:"primary",onClick:p,children:"Cancel"}),e.jsx(m,{disableElevation:!0,disabled:h,size:"small",type:"submit",variant:"contained",color:"primary",sx:{marginLeft:"10px"},children:"Ok"})]})})]})})})})}function te({open:i,setOpen:s}){const o=y(),n=()=>{s(!1)};return e.jsx(r.Fragment,{children:e.jsxs(k,{open:i,onClose:n,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",sx:{"& .MuiDialogTitle-root":{background:`${o.palette.secondary[200]}`,marginBottom:"5px"}},children:[e.jsx(z,{id:"alert-dialog-title",sx:{fontSize:"16px",fontWeight:"Bold",lineHeight:"24px"},children:"Thêm tác giả"}),e.jsx(D,{children:e.jsx(ee,{open:i,setOpen:s})})]})})}function ae({setOpenEdit:i,author:s}){const o=w(),n=C(a=>a.organizationReducer),l=async a=>{(await A.EditAuthorNew({AuthorName:a.AuthorName},s.id)).status==200&&(o(F.status(!n.isFresh)),i(!1))},p=()=>{i(!1)};return e.jsx(e.Fragment,{children:e.jsx(E,{initialValues:{AuthorName:s==null?void 0:s.AuthorName,submit:null},validationSchema:I().shape({AuthorName:H().max(255).required("AuthorName is required")}),onSubmit:l,children:({errors:a,handleBlur:u,handleChange:x,handleSubmit:g,isSubmitting:h,touched:j,values:b})=>e.jsx("form",{noValidate:!0,onSubmit:g,children:e.jsxs(c,{container:!0,spacing:3,children:[e.jsx(R,{id:"author",lable:"Tên tác giả",values:b,placeholder:"Nhập tên tác giả",nameValue:"AuthorName",handleBlur:u,handleChange:x,touched:j,errors:a}),e.jsx(c,{item:!0,xs:12,sx:{mt:-1}}),a.submit&&e.jsx(c,{item:!0,xs:12,children:e.jsx(M,{error:!0,children:a.submit})}),e.jsx(c,{item:!0,xs:12,children:e.jsxs(f,{style:{float:"right"},children:[e.jsx(m,{disableElevation:!0,disabled:h,size:"small",variant:"contained",color:"primary",onClick:p,children:"Cancel"}),e.jsx(m,{disableElevation:!0,disabled:h,size:"small",type:"submit",variant:"contained",color:"primary",sx:{marginLeft:"10px"},children:"Ok"})]})})]})})})})}function se({openEdit:i,setOpenEdit:s,author:o}){const n=y(),l=()=>{s(!1)};return e.jsx(r.Fragment,{children:e.jsxs(k,{open:i,onClose:l,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",sx:{"& .MuiDialogTitle-root":{background:`${n.palette.secondary[200]}`,marginBottom:"5px"}},children:[e.jsx(z,{id:"alert-dialog-title",sx:{fontSize:"16px",fontWeight:"Bold",lineHeight:"24px"},children:"Cập nhật thông tin tác giả"}),e.jsx(D,{children:e.jsx(ae,{setOpenEdit:s,author:o})})]})})}function ie(){const[i,s]=r.useState(!1),o=w(),n=C(t=>t.organizationReducer),[l,p]=r.useState([]),[a,u]=r.useState({}),x=async(t,d)=>{const S=await A.getAuthorNew({page:t,size:d});p(S.result.rows)};r.useEffect(()=>{x(0,10)},[n.isFresh]);const[g,h]=r.useState(1),[j,b]=r.useState(10),[T,P]=r.useState([]),V=async()=>{var t;(t=T[0])!=null&&t.id?(await A.DeleteAuthorNew(T[0].id)).status==200&&o(F.status(!n.isFresh)):J.error("Chọn tác giả để xóa!")},L=t=>{u(t),s(!i)},N=l==null?void 0:l.map((t,d)=>({STT:(g-1)*j+d+1,AuthorName:t==null?void 0:t.AuthorName,id:t==null?void 0:t.id})),$=[{field:"STT",headerName:"STT",flex:.5},{field:"id",headerName:"Id",flex:1},{field:"AuthorName",headerName:"Tên tác giả",flex:1},{field:"action",align:"left",headerName:"Chỉnh sửa thông tin",flex:.5,renderCell:t=>e.jsx(e.Fragment,{children:e.jsx(U,{type:"edit",onClick:()=>L(t.row)})})}],q=(t,d)=>{h(d),x(d-1,10)},[v,B]=r.useState(!1),G=()=>{B(!v)},O=y();return e.jsxs(X,{children:[e.jsxs(K,{children:[e.jsx(f,{}),e.jsxs(f,{children:[e.jsx(m,{component:"label",onClick:G,sx:{whiteSpace:"nowrap",padding:"5px 15px 5px 15px"},role:void 0,variant:"contained",tabIndex:-1,startIcon:e.jsx(Q,{}),children:"Thêm tác giả"}),e.jsx(m,{component:"label",onClick:V,sx:{whiteSpace:"nowrap",padding:"5px 15px 5px 15px",marginLeft:"5px"},role:void 0,variant:"contained",tabIndex:-1,startIcon:e.jsx(Y,{}),children:"Xóa"})]})]}),N?e.jsx(Z,{rows:N,columns:$,disableColumnMenu:!0,checkboxSelection:!0,rowHeight:40,columnHeaderHeight:45,autoHeight:!0,sx:{border:2,borderColor:O.palette.secondary.light},onRowSelectionModelChange:t=>{const d=new Set(t),S=N.filter(W=>d.has(W.id.toString()));P(S)}}):"Loading",e.jsx(f,{sx:{display:"flex",justifyContent:"center",marginTop:"10px",paddingBottom:"10px"},children:e.jsx(_,{count:10,color:"primary",onChange:q})}),e.jsx(se,{openEdit:i,setOpenEdit:s,author:a}),e.jsx(te,{open:v,setOpen:B})]})}const ge=()=>e.jsx(e.Fragment,{children:e.jsx(ie,{})});export{ge as default};
