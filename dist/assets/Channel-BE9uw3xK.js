import{H as k,I as w,j as e,G as h,B as f,u as F,r,J as X}from"./index-BV4Nease.js";import{O as R,D as z,a as E,b as L,B as Q,c as U,R as Y,d as Z}from"./BoxCover-D9rhDFlx.js";import{a as b}from"./channel-C607U_8l.js";import{F as q,c as M,a as I}from"./formik.esm-DZjldY3N.js";import{a as T,R as _,S as ee,P as ae}from"./StyledDataGrid-FNaFrEdc.js";import{A}from"./AutocompleteForm-DM2Ck111.js";import{F as H,B as y}from"./InputLabel-WUsojO3a.js";import"./baseaxios-CTVpXELN.js";import"./TextField-BhRWA0TT.js";import"./FormControlLabel-M6Lp4kHF.js";import"./Skeleton-KZcenIcW.js";function te({open:i,setOpen:n,categoryChanel:c}){const l=k(),o=w(t=>t.organizationReducer),u=async t=>{console.log("Kiêm tra dữ liệu",t),(await b.AddChannel({ChannelName:t.ChannelName,CategoryId:t.CategoryId})).status==200&&(l(T.status(!o.isFresh)),n(!1))},j=()=>{n(!1)};return e.jsx(e.Fragment,{children:e.jsx(q,{initialValues:{ChannelName:"",CategoryId:"",submit:null},validationSchema:M().shape({ChannelName:I().max(255).required("ChannelName is required"),CategoryId:I().max(255).required("CategoryId is required")}),onSubmit:u,children:({errors:t,handleBlur:d,handleChange:x,handleSubmit:p,isSubmitting:m,touched:g,values:C})=>e.jsx("form",{noValidate:!0,onSubmit:p,children:e.jsxs(h,{container:!0,spacing:3,children:[e.jsx(R,{id:"nameChanel",lable:"Tên kênh truyền thông",values:C,placeholder:"Nhập tên kênh truyền thông",nameValue:"ChannelName",handleBlur:d,handleChange:x,touched:g,errors:t}),e.jsx(A,{touched:g,data:c,handleBlur:d,errors:t,values:C,handleChange:x,inputLable:"Danh mục kênh truyền thông",valueId:"CategoryId",valueLable:"CategoryName"}),e.jsx(h,{item:!0,xs:12,sx:{mt:-1}}),t.submit&&e.jsx(h,{item:!0,xs:12,children:e.jsx(H,{error:!0,children:t.submit})}),e.jsx(h,{item:!0,xs:12,children:e.jsxs(f,{style:{float:"right"},children:[e.jsx(y,{disableElevation:!0,disabled:m,size:"small",variant:"contained",color:"primary",onClick:j,children:"Cancel"}),e.jsx(y,{disableElevation:!0,disabled:m,size:"small",type:"submit",variant:"contained",color:"primary",sx:{marginLeft:"10px"},children:"Ok"})]})})]})})})})}function ne({open:i,setOpen:n,categoryChanel:c}){const l=F(),o=()=>{n(!1)};return e.jsx(r.Fragment,{children:e.jsxs(z,{open:i,onClose:o,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",sx:{"& .MuiDialogTitle-root":{background:`${l.palette.secondary[200]}`,marginBottom:"5px"}},children:[e.jsx(E,{id:"alert-dialog-title",sx:{fontSize:"16px",fontWeight:"Bold",lineHeight:"24px"},children:"Thêm kênh truyền thông"}),e.jsx(L,{children:e.jsx(te,{open:i,setOpen:n,categoryChanel:c})})]})})}function se({setOpenEdit:i,channel:n,categoryChanel:c}){const l=k(),o=w(t=>t.organizationReducer),u=async t=>{(await b.EditChannel({ChannelName:t.ChannelName,CategoryId:t.CategoryId},n.id)).status==200&&(l(T.status(!o.isFresh)),i(!1))},j=()=>{i(!1)};return e.jsx(e.Fragment,{children:e.jsx(q,{initialValues:{ChannelName:n==null?void 0:n.ChannelName,CategoryId:n==null?void 0:n.CategoryId,submit:null},validationSchema:M().shape({ChannelName:I().max(255).required("ChannelName is required"),CategoryId:I().max(255).required("CategoryId is required")}),onSubmit:u,children:({errors:t,handleBlur:d,handleChange:x,handleSubmit:p,isSubmitting:m,touched:g,values:C})=>e.jsx("form",{noValidate:!0,onSubmit:p,children:e.jsxs(h,{container:!0,spacing:3,children:[e.jsx(R,{id:"nameChanel",lable:"Tên kênh truyền thông",values:C,placeholder:"Nhập tên kênh truyền thông",nameValue:"ChannelName",handleBlur:d,handleChange:x,touched:g,errors:t}),e.jsx(A,{touched:g,data:c,handleBlur:d,errors:t,values:C,handleChange:x,inputLable:"Danh mục kênh truyền thông",valueId:"CategoryId",valueLable:"CategoryName"}),e.jsx(h,{item:!0,xs:12,sx:{mt:-1}}),t.submit&&e.jsx(h,{item:!0,xs:12,children:e.jsx(H,{error:!0,children:t.submit})}),e.jsx(h,{item:!0,xs:12,children:e.jsxs(f,{style:{float:"right"},children:[e.jsx(y,{disableElevation:!0,disabled:m,size:"small",variant:"contained",color:"primary",onClick:j,children:"Cancel"}),e.jsx(y,{disableElevation:!0,disabled:m,size:"small",type:"submit",variant:"contained",color:"primary",sx:{marginLeft:"10px"},children:"Ok"})]})})]})})})})}function re({openEdit:i,setOpenEdit:n,channel:c,categoryChanel:l}){const o=F(),u=()=>{n(!1)};return e.jsx(r.Fragment,{children:e.jsxs(z,{open:i,onClose:u,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",sx:{"& .MuiDialogTitle-root":{background:`${o.palette.secondary[200]}`,marginBottom:"5px"}},children:[e.jsx(E,{id:"alert-dialog-title",sx:{fontSize:"16px",fontWeight:"Bold",lineHeight:"24px"},children:"Cập nhật thông tin kênh truyền thông"}),e.jsx(L,{children:e.jsx(se,{setOpenEdit:n,channel:c,categoryChanel:l})})]})})}function ie(){const[i,n]=r.useState(!1),c=k(),l=w(a=>a.organizationReducer),[o,u]=r.useState([]),[j,t]=r.useState({}),[d,x]=r.useState([]),p=async(a,s)=>{const S=await b.getChannel({page:a,size:s});u(S.result.rows)};r.useEffect(()=>{p(0,10)},[l.isFresh]),r.useEffect(()=>{(async()=>{const s=await b.categoryChanel();x(s.result.rows)})()},[]);const[m,g]=r.useState(1),[C,oe]=r.useState(10),[D,P]=r.useState([]),V=async()=>{var a,s;(a=D[0])!=null&&a.id?(await b.DeleteChannel((s=D[0])==null?void 0:s.id)).status==200&&c(T.status(!l.isFresh)):X.error("Chọn kênh để xóa!")},$=a=>{t(a),n(!i)},N=o==null?void 0:o.map((a,s)=>({STT:(m-1)*C+s+1,ChannelName:a==null?void 0:a.ChannelName,Category:a==null?void 0:a.Category.CategoryName,CategoryId:a==null?void 0:a.Category.id,id:a==null?void 0:a.id})),G=[{field:"STT",headerName:"STT",flex:.5},{field:"ChannelName",headerName:"Kêng truyền thông",flex:1},{field:"Category",headerName:"Danh mục ",flex:1},{field:"action",align:"left",headerName:"Chỉnh sửa thông tin",flex:.5,renderCell:a=>e.jsx(e.Fragment,{children:e.jsx(Z,{type:"edit",onClick:()=>$(a.row)})})}],O=(a,s)=>{g(s),p(s-1,10)},[v,B]=r.useState(!1),K=()=>{B(!v)},W=F();return e.jsxs(Q,{children:[e.jsxs(U,{children:[e.jsx(f,{}),e.jsxs(f,{children:[e.jsx(y,{component:"label",onClick:K,sx:{whiteSpace:"nowrap",padding:"5px 15px 5 15px"},role:void 0,variant:"contained",tabIndex:-1,startIcon:e.jsx(Y,{}),children:"Thêm kênh"}),e.jsx(y,{component:"label",onClick:V,sx:{whiteSpace:"nowrap",padding:"5px 15px 5px 15px",marginLeft:"5px"},role:void 0,variant:"contained",tabIndex:-1,startIcon:e.jsx(_,{}),children:"Xóa"})]})]}),N?e.jsx(ee,{rows:N,columns:G,disableColumnMenu:!0,checkboxSelection:!0,rowHeight:40,columnHeaderHeight:45,sx:{border:2,borderColor:W.palette.secondary.light},onRowSelectionModelChange:a=>{const s=new Set(a),S=N.filter(J=>s.has(J.id.toString()));P(S)}}):"Loading",e.jsx(f,{sx:{display:"flex",justifyContent:"center",marginTop:"10px",paddingBottom:"10px"},children:e.jsx(ae,{count:10,color:"primary",onChange:O})}),e.jsx(re,{openEdit:i,setOpenEdit:n,channel:j,categoryChanel:d}),e.jsx(ne,{open:v,setOpen:B,categoryChanel:d})]})}const fe=()=>e.jsx(e.Fragment,{children:e.jsx(ie,{})});export{fe as default};
