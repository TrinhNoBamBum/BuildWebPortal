import{H as y,I as w,j as e,G as m,B as S,u as z,r as l,J}from"./index-BV4Nease.js";import{O as U,D as B,a as E,b as I,B as X,c as Q,R as Y,d as Z}from"./BoxCover-D9rhDFlx.js";import{a as C}from"./organization-TJxYY1sJ.js";import{F as M,c as q,a as v}from"./formik.esm-DZjldY3N.js";import{a as T,R as _,S as ee,P as te}from"./StyledDataGrid-FNaFrEdc.js";import{F as H,B as f}from"./InputLabel-WUsojO3a.js";import"./baseaxios-CTVpXELN.js";import"./TextField-BhRWA0TT.js";import"./FormControlLabel-M6Lp4kHF.js";import"./Skeleton-KZcenIcW.js";function ne({open:s,setOpen:a}){const o=y(),r=w(n=>n.organizationReducer),d=async n=>{(await C.AddOrganization({UnitName:n.UnitName,UnitFullName:n.UnitFullName})).status==200&&(o(T.status(!r.isFresh)),a(!1))},b=()=>{a(!1)};return e.jsx(e.Fragment,{children:e.jsx(M,{initialValues:{UnitName:"",UnitFullName:"",submit:null},validationSchema:q().shape({UnitName:v().max(255).required("UnitName is required"),UnitFullName:v().max(255).required("UnitFullName is required")}),onSubmit:d,children:({errors:n,handleBlur:c,handleChange:x,handleSubmit:N,isSubmitting:h,touched:p,values:u})=>e.jsx("form",{noValidate:!0,onSubmit:N,children:e.jsxs(m,{container:!0,spacing:3,children:[e.jsx(U,{id:"sign",lable:"Kí hiệu đơn vị",values:u,placeholder:"Nhập kí hiệu đơn vị",nameValue:"UnitName",handleBlur:c,handleChange:x,touched:p,errors:n}),e.jsx(U,{id:"nameOr",lable:"Tên đơn vị",values:u,placeholder:"Nhập tên đơn vị",nameValue:"UnitFullName",handleBlur:c,handleChange:x,touched:p,errors:n}),e.jsx(m,{item:!0,xs:12,sx:{mt:-1}}),n.submit&&e.jsx(m,{item:!0,xs:12,children:e.jsx(H,{error:!0,children:n.submit})}),e.jsx(m,{item:!0,xs:12,children:e.jsxs(S,{style:{float:"right"},children:[e.jsx(f,{disableElevation:!0,disabled:h,size:"small",variant:"contained",color:"primary",onClick:b,children:"Cancel"}),e.jsx(f,{disableElevation:!0,disabled:h,size:"small",type:"submit",variant:"contained",color:"primary",sx:{marginLeft:"10px"},children:"Ok"})]})})]})})})})}function ae({open:s,setOpen:a}){const o=z(),r=()=>{a(!1)};return e.jsx(l.Fragment,{children:e.jsxs(B,{open:s,onClose:r,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",sx:{"& .MuiDialogTitle-root":{background:`${o.palette.secondary[200]}`,marginBottom:"5px"}},children:[e.jsx(E,{id:"alert-dialog-title",sx:{fontSize:"16px",fontWeight:"Bold",lineHeight:"24px"},children:"Thêm đơn vị"}),e.jsx(I,{children:e.jsx(ne,{open:s,setOpen:a})})]})})}function ie({setOpenEdit:s,organ:a}){const o=y(),r=w(n=>n.organizationReducer),d=async n=>{(await C.EditOrganization({UnitName:n.UnitName,UnitFullName:n.UnitFullName},a.id)).status==200&&(o(T.status(!r.isFresh)),s(!1))},b=()=>{s(!1)};return e.jsx(e.Fragment,{children:e.jsx(M,{initialValues:{UnitName:a==null?void 0:a.UnitName,UnitFullName:a==null?void 0:a.UnitFullName,submit:null},validationSchema:q().shape({UnitName:v().max(255).required("UnitName is required"),UnitFullName:v().max(255).required("UnitFullName is required")}),onSubmit:d,children:({errors:n,handleBlur:c,handleChange:x,handleSubmit:N,isSubmitting:h,touched:p,values:u})=>e.jsx("form",{noValidate:!0,onSubmit:N,children:e.jsxs(m,{container:!0,spacing:3,children:[e.jsx(U,{id:"sign",lable:"Kí hiệu đơn vị",values:u,placeholder:"Nhập kí hiệu đơn vị",nameValue:"UnitName",handleBlur:c,handleChange:x,touched:p,errors:n}),e.jsx(U,{id:"nameOr",lable:"Tên đơn vị",values:u,placeholder:"Nhập tên đơn vị",nameValue:"UnitFullName",handleBlur:c,handleChange:x,touched:p,errors:n}),e.jsx(m,{item:!0,xs:12,sx:{mt:-1}}),n.submit&&e.jsx(m,{item:!0,xs:12,children:e.jsx(H,{error:!0,children:n.submit})}),e.jsx(m,{item:!0,xs:12,children:e.jsxs(S,{style:{float:"right"},children:[e.jsx(f,{disableElevation:!0,disabled:h,size:"small",variant:"contained",color:"primary",onClick:b,children:"Cancel"}),e.jsx(f,{disableElevation:!0,disabled:h,size:"small",type:"submit",variant:"contained",color:"primary",sx:{marginLeft:"10px"},children:"Ok"})]})})]})})})})}function se({openEdit:s,setOpenEdit:a,organ:o}){const r=z(),d=()=>{a(!1)};return e.jsx(l.Fragment,{children:e.jsxs(B,{open:s,onClose:d,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",sx:{"& .MuiDialogTitle-root":{background:`${r.palette.secondary[200]}`,marginBottom:"5px"}},children:[e.jsx(E,{id:"alert-dialog-title",sx:{fontSize:"16px",fontWeight:"Bold",lineHeight:"24px"},children:"Sửa thông tin đơn vị"}),e.jsx(I,{children:e.jsx(ie,{setOpenEdit:a,organ:o})})]})})}function le(){const[s,a]=l.useState(!1),o=y(),r=w(t=>t.organizationReducer),[d,b]=l.useState([]),[n,c]=l.useState({}),[x,N]=l.useState(1),[h,p]=l.useState(10),[u,O]=l.useState([]),[R,k]=l.useState(!1),D=async(t,i)=>{var j;const g=await C.getOrganizations({page:t,size:i});b((j=g.result)==null?void 0:j.rows)};l.useEffect(()=>{D(0,10)},[r.isFresh]);const V=async()=>{var t,i;(t=u[0])!=null&&t.id?(await C.DeleteOrganization((i=u[0])==null?void 0:i.id)).status===200&&o(T.status(!r.isFresh)):J.error("Chọn đơn vị để xóa!")},P=t=>{c(t),a(!s)},F=d==null?void 0:d.map((t,i)=>({STT:(x-1)*h+i+1,UnitFullName:t==null?void 0:t.UnitFullName,UnitName:t==null?void 0:t.UnitName,id:t==null?void 0:t.id})),A=[{field:"STT",headerName:"STT",flex:.5},{field:"UnitName",headerName:"Ký hiệu",flex:1},{field:"UnitFullName",headerName:"Tên đơn vị",flex:1},{field:"action",align:"left",headerName:"Chỉnh sửa thông tin",flex:.5,renderCell:t=>e.jsx(e.Fragment,{children:e.jsx(Z,{type:"edit",onClick:()=>P(t.row)})})}],L=(t,i)=>{N(i),D(i-1,10)},$=()=>{k(!R)},G=z(),[oe,K]=l.useState(null),W=t=>{const i=t.length?t[t.length-1]:null,g=F.filter(j=>j.id.toString()===i);K(i?[i]:[]),O(g)};return e.jsxs(X,{children:[e.jsxs(Q,{children:[e.jsx(S,{}),e.jsxs(S,{children:[e.jsx(f,{component:"label",onClick:$,sx:{whiteSpace:"nowrap",padding:"5px 15px 5px 15px"},role:void 0,variant:"contained",tabIndex:-1,startIcon:e.jsx(Y,{}),children:"Thêm đơn vị"}),e.jsx(f,{component:"label",onClick:V,sx:{whiteSpace:"nowrap",padding:"5px 15px 5px 15px",marginLeft:"5px"},role:void 0,variant:"contained",tabIndex:-1,startIcon:e.jsx(_,{}),children:"Xóa"})]})]}),F?e.jsx(ee,{rows:F,columns:A,disableColumnMenu:!0,rowHeight:40,columnHeaderHeight:45,autoHeight:!0,sx:{border:2,borderColor:G.palette.secondary.light},onSelectionModelChange:W,checkboxSelection:!0,onRowSelectionModelChange:t=>{const i=new Set(t),g=F.filter(j=>i.has(j.id.toString()));O(g)}}):"Loading",e.jsx(S,{sx:{display:"flex",justifyContent:"center",marginTop:"10px",paddingBottom:"10px"},children:e.jsx(te,{count:10,color:"primary",onChange:L})}),e.jsx(se,{openEdit:s,setOpenEdit:a,organ:n}),e.jsx(ae,{open:R,setOpen:k})]})}const be=()=>e.jsx(e.Fragment,{children:e.jsx(le,{})});export{be as default};
