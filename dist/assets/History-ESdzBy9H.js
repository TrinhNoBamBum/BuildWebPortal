import{J as c,u as k,H as m,I as C,r as n,j as a,B as h,aI as H}from"./index-BV4Nease.js";import{R as I,S as B,P as R,a as T}from"./StyledDataGrid-FNaFrEdc.js";import{b as g}from"./baseaxios-CTVpXELN.js";import{B as v}from"./InputLabel-WUsojO3a.js";import"./TextField-BhRWA0TT.js";import"./FormControlLabel-M6Lp4kHF.js";import"./Skeleton-KZcenIcW.js";const N=async r=>{try{const s=await g({method:"POST",url:"backup-data",data:r});return s.data.status==200?c.success("Sao lưu dữ liệu thành công!"):c.error("Đã có lỗi xảy ra"),s}catch(s){return c.error(s.message),s}},A=async r=>{try{return(await g({method:"GET",url:"backup-data",params:r})).data}catch(s){c.error(s.message)}},x={saveData:N,getHistory:A},P=()=>{const r=k(),s=m(),i=C(e=>e.organizationReducer),[F,f]=n.useState(1);n.useState(10);const[u,y]=n.useState([]),[d,S]=n.useState([]),p=async(e,t)=>{const o=await x.getHistory({page:e,size:t});S(o==null?void 0:o.result.rows)};n.useEffect(()=>{p(0,10)},[i.isFresh]);const w=async()=>{var e;(e=u[0])!=null&&e.id?(await x.DeleteTopic(u[0].id)).status===200&&s(T.status(!i.isFresh)):c.error("Chọn chủ đề để xóa!")},b=(e,t)=>{f(t),p(t-1,10)},l=d==null?void 0:d.map((e,t)=>({id:e==null?void 0:e.id,BackupName:e==null?void 0:e.BackupName,SaveDir:e==null?void 0:e.SaveDir,Status:e==null?void 0:e.Status,AccountId:e==null?void 0:e.AccountId,createdAt:e==null?void 0:e.createdAt})),j=[{field:"createdAt",headerName:"Thời gian",flex:.5},{field:"BackupName",headerName:"Tên tệp",flex:1},{field:"SaveDir",headerName:"Ổ đĩa",flex:1},{field:"AccountId",headerName:"Id người tạo",flex:1}];return a.jsxs("div",{style:{height:"70%",width:"100%",background:"#fff",border:"1px solid",borderColor:r.palette.grey.A800,paddingTop:5},children:[a.jsxs(h,{sx:{display:"flex",padding:"5px"},children:[a.jsx(H,{placeholder:"Nhật ký tìm kiếm"}),a.jsx(v,{component:"label",onClick:w,sx:{whiteSpace:"nowrap",padding:"0 25px 0 25px",marginLeft:"5px"},role:void 0,variant:"contained",tabIndex:-1,startIcon:a.jsx(I,{}),children:"Xóa"})]}),l?a.jsx(B,{rows:l,columns:j,disableColumnMenu:!0,checkboxSelection:!0,rowHeight:40,columnHeaderHeight:45,sx:{border:2,borderColor:r.palette.secondary.light},onRowSelectionModelChange:e=>{const t=new Set(e),o=l.filter(D=>t.has(D.id.toString()));console.log(o),y(o)}}):a.jsx(a.Fragment,{}),a.jsx(h,{sx:{display:"flex",justifyContent:"center",marginTop:"10px",paddingBottom:"10px"},children:a.jsx(R,{count:10,color:"primary",onChange:b})})]})},q=()=>a.jsx(a.Fragment,{children:a.jsx(P,{})});export{q as default};
